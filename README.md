# PAKDD2020 阿里巴巴智能运维算法大赛

## 一、 解决方案及算法

### 1. 数据预处理

对于给定的`.csv`文件，分块读入处理，首先将全部缺失的列去除，然后对数据生成标记。

一共使用到了三种标记`tag, flag, 30_day` ，其中`flag=1`标记表示硬盘损坏当天的数据，`30_day=1`表示距离该硬盘损坏日期刚好为30天的数据，`tag`不为0表示数据处于损坏前30天到损坏日期的窗口之内。由于比赛的评价标准是预测硬盘在未来30日内是否出现故障，认为硬盘在出现故障之前的30日内应该有不同于正常硬盘的特征，故采取将数据集内距离损坏日期30日内的数据全部进行标记用于训练。

随后为了提高处理效率，更改了数据类型，特征列根据特征的数值范围来判断是否使用`float32`来优化存储，最后将2017年及2018年的数据分别生成`.h5`文件存储。

### 2. 特征工程

对于时间序列数据，首先对于缺失值进行了填充。

根据业务知识，采用滑动窗口构建新的特征

`TODO`

### 3. 模型训练

将赛题任务视为二分类的任务，通过预测硬盘在每一天的`tag`来判断在其后的30天内是否会出现损坏。

采用 lightgbm 模型完成分类任务，由于标记数据时对发生故障的前30天都进行了标记，在对于8月份的测试集做预测时，无法获取这部分盘在7月份的数据标签，因此在训练的时候采取隔月验证的思路来评估模型的表现。比如使用2018年2月至3月的数据作为训练集，则采用2018年5月的数据作为验证集，评估模型的表现。

### 4. 任务预测

使用训练好的模型对于测试集数据进行预测，根据输出的概率进行排序，对结果进行一定数量的截断，取排名靠前的部分预测结果作为最终结果进行提交。

`TODO`

## 二、代码运行说明

### 1. 数据预处理 

程序`code/data_preparing.py`

直接运行 `python data_preparing.py` 生成得到2017年以及2018年的数据的`.h5`文件。

### 2. 特征工程

程序 `code/feature_engineering.py`

定义好相应参数，直接运行得到特征工程处理过后的数据集。

### 3. 模型训练

程序 `code/train.py`

定义好模型参数，运行程序对模型进行训练。

### 4. 任务预测

程序 `code/predict.py`

使用训练好的模型运行得到对应的预测结果。